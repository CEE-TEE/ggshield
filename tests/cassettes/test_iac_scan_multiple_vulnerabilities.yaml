interactions:
  - request:
      body: !!binary |
        LS1hODQ4NjZmZGIyZTZjMzU2NWNmNDM4MWIxODQzYzE0OA0KQ29udGVudC1EaXNwb3NpdGlvbjog
        Zm9ybS1kYXRhOyBuYW1lPSJzY2FuX3BhcmFtZXRlcnMiDQoNCnsiaWdub3JlZF9wb2xpY2llcyI6
        IFtdLCAibWluaW11bV9zZXZlcml0eSI6ICJMT1cifQ0KLS1hODQ4NjZmZGIyZTZjMzU2NWNmNDM4
        MWIxODQzYzE0OA0KQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJkaXJlY3Rv
        cnkiOyBmaWxlbmFtZT0iZGlyZWN0b3J5Ig0KDQofiwgAbTDVYgL/7dO7boMwGAVgZj+F5QcgBlNg
        idSxY/eqshxiIquGIF/aRFXevQ6RWlVVMrUZ0vMx+BcYnwFOvsgX949q96DVWrvsT/CTcyvnQnzN
        x/sFL4sio7vsCqIPyqX47H8qGzoEM+hlUd+1hWgbIfK2akTVkgxun1Gd7I3Vcog2mCkNr9GO2qmV
        sSYY7fPQ/0b/66qa16auT10vq8/Oi1T2b/0vOS/KjPJr9n+yyqpx1Of2pW19f3vfnzjtt9F1mjL1
        5qXXXXQm7OXGbePEKFuptdQ7NaQ/g9F3QqnepDf8PFLambWTK7vtXjxd0ifG8/lacPacnh/IgRB6
        KUC6eDz3Z0rYTzqdyMw4xzFyOSvloMoAAAAAAAAAAAAAAAAAAADwT30A5hubOQAoAAANCi0tYTg0
        ODY2ZmRiMmU2YzM1NjVjZjQzODFiMTg0M2MxNDgtLQ0K
      headers:
        Accept:
          - '*/*'
        Accept-Encoding:
          - gzip, deflate
        Connection:
          - keep-alive
        Content-Length:
          - '603'
        Content-Type:
          - multipart/form-data; boundary=a84866fdb2e6c3565cf4381b1843c148
        GGShield-Command-Path:
          - cli iac scan
        GGShield-Version:
          - 1.12.0
        User-Agent:
          - pygitguardian/1.3.5 (Darwin;py3.10.0) ggshield
      method: POST
      uri: https://api.gitguardian.com/v1/iac_scan
    response:
      body:
        string:
          '{"id":"0","type":"path_scan","iac_engine_version":"1.5.0","entities_with_incidents":[{"filename":"iac_file_multiple_vulnerabilities.tf","incidents":[{"policy":"Unrestricted
          egress traffic might lead to remote code execution","policy_id":"GG_IAC_0002","severity":"HIGH","component":"aws_security_group.bad_example","line_end":4,"line_start":4,"description":"Open
          egress means that the asset can download data from the whole web.","documentation_url":"https://gitguardian.com"},{"policy":"Unrestricted
          ingress traffic leaves assets exposed to remote attacks","policy_id":"GG_IAC_0003","severity":"HIGH","component":"aws_security_group_rule.bad_example","line_end":10,"line_start":10,"description":"A
          security group has open ingress from all IPs, and on all ports. This means
          that the\nassets in this security group are exposed to the whole web.\n\nFurthermore,
          no port range is specified. This\nmeans that some applications running on
          assets of this security group may be reached by\nexternal traffic, while they
          are not expected to do so.","documentation_url":"https://gitguardian.com"}]}]}'
      headers:
        Access-Control-Expose-Headers:
          - X-App-Version
        Allow:
          - POST, OPTIONS
        Connection:
          - keep-alive
        Content-Type:
          - application/json
        Date:
          - Mon, 18 Jul 2022 10:05:35 GMT
        Referrer-Policy:
          - strict-origin-when-cross-origin
        Server:
          - nginx
        Set-Cookie:
          - AWSALB=B4kQnX/9ag6+fudX+qUMgCeNpKXRBX0zaTkuCyfmZQzzLLHfc1ntZp/3N1uJZiWjiO4GHUc1ogVbelEU8qyTP4P0vvDuR/Vu86Blkr4/4+zqxygZ+QmxFaJcfTHT;
            Expires=Mon, 25 Jul 2022 10:05:34 GMT; Path=/
          - AWSALBCORS=B4kQnX/9ag6+fudX+qUMgCeNpKXRBX0zaTkuCyfmZQzzLLHfc1ntZp/3N1uJZiWjiO4GHUc1ogVbelEU8qyTP4P0vvDuR/Vu86Blkr4/4+zqxygZ+QmxFaJcfTHT;
            Expires=Mon, 25 Jul 2022 10:05:34 GMT; Path=/; SameSite=None; Secure
        Strict-Transport-Security:
          - max-age=31536000; includeSubDomains
        Transfer-Encoding:
          - chunked
        Vary:
          - Accept-Encoding
          - Cookie
        X-App-Version:
          - v2.9.0
        X-Content-Type-Options:
          - nosniff
          - nosniff
        X-Frame-Options:
          - DENY
          - SAMEORIGIN
        X-Secrets-Engine-Version:
          - 2.71.0
        X-XSS-Protection:
          - 1; mode=block
        content-length:
          - '1089'
      status:
        code: 200
        message: OK
version: 1
